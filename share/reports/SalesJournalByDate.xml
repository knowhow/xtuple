<!DOCTYPE openRPTDef>
<report>
 <title>Sales Journal</title>
 <name>SalesJournalByDate</name>
 <description></description>
 <size>Letter</size>
 <portrait/>
 <topmargin>50</topmargin>
 <bottommargin>50</bottommargin>
 <rightmargin>50</rightmargin>
 <leftmargin>50</leftmargin>
 <querysource>
  <name>detail</name>
  <sql>SELECT cust_number, cust_name, aropen_docnumber, aropen_doctype, formatDate(aropen_docdate) AS docdate,
               aropen_applyto, formatExtPrice(currtobase(aropen_curr_id,aropen_amount,aropen_docdate)) AS openamount, aropen_ponumber,
               accnt_number, accnt_descrip,
               CASE WHEN (gltrans_amount &lt; 0) THEN formatExtPrice(ABS(gltrans_amount))
                         ELSE ''
               END AS debit,
               CASE WHEN (gltrans_amount > 0) THEN formatExtPrice(gltrans_amount)
                         ELSE ''
               END AS credit,
               CASE WHEN (aropen_doctype IN ('C', 'R')) THEN 'CR'
                         WHEN (aropen_doctype='I') THEN '  '
               END AS docsence
FROM aropen, gltrans, cust, accnt
WHERE ((aropen_cust_id=cust_id)
 AND (aropen_docnumber=gltrans_docnumber)
 AND ( ( (aropen_doctype='I') AND (gltrans_doctype='IN') ) OR ( (aropen_doctype IN ('C', 'R')) AND (gltrans_doctype='CM') ) )
 AND (gltrans_accnt_id=accnt_id)
 AND (gltrans_date BETWEEN &lt;? value("startDate") ?> AND &lt;? value("endDate") ?>)
 AND (gltrans_source='S/O')
 AND (aropen_docdate BETWEEN &lt;? value("startDate") ?> AND &lt;? value("endDate") ?>) )
ORDER BY aropen_docnumber, gltrans_amount, accnt_number;
    </sql>
 </querysource>
 <querysource>
  <name>distributions</name>
  <sql>SELECT 1 as gid, accnt_number, accnt_descrip,
         formatExtPrice(SUM(ABS(gltrans_amount))) AS debit,
         '' AS credit
FROM gltrans, accnt
WHERE ((gltrans_accnt_id=accnt_id)
 AND (gltrans_amount &lt; 0)
 AND (gltrans_date BETWEEN &lt;? value("startDate") ?> AND &lt;? value("endDate") ?>)
 AND (gltrans_source='S/O'))
GROUP BY accnt_number, accnt_descrip
UNION SELECT 1 as gid, accnt_number, accnt_descrip,
                           '' AS debit,
                           formatExtPrice(SUM(gltrans_amount)) AS credit
FROM gltrans, accnt
WHERE ((gltrans_accnt_id=accnt_id)
 AND (gltrans_amount >= 0)
 AND (gltrans_date BETWEEN &lt;? value("startDate") ?> AND &lt;? value("endDate") ?>)
 AND (gltrans_source='S/O'))
GROUP BY accnt_number, accnt_descrip; </sql>
 </querysource>
 <querysource>
  <name>totaldocsales</name>
  <sql>SELECT formatExtPrice(SUM(COALESCE(currtobase(aropen_curr_id,aropen_amount,aropen_docdate), 0))) AS amount
FROM aropen
WHERE ((aropen_doctype='I')
 AND (aropen_docdate BETWEEN &lt;? value("startDate") ?> AND &lt;? value("endDate") ?>));
    </sql>
 </querysource>
 <querysource>
  <name>totaldoccredit</name>
  <sql>SELECT formatExtPrice(SUM(COALESCE(currtobase(aropen_curr_id,aropen_amount,aropen_docdate), 0))) AS amount
FROM aropen
WHERE ((aropen_doctype IN ('C', 'R'))
 AND (aropen_docdate BETWEEN &lt;? value("startDate") ?> AND &lt;? value("endDate") ?>));
    </sql>
 </querysource>
 <querysource>
  <name>foot</name>
  <sql>SELECT formatExtPrice(SUM( CASE WHEN (aropen_doctype IN ('C', 'R')) THEN (currtobase(aropen_curr_id,aropen_amount,aropen_docdate) * -1)
                                                           WHEN (aropen_doctype='I') THEN (currtobase(aropen_curr_id,aropen_amount,aropen_docdate))
                                                 END )) AS totalamount
FROM aropen
WHERE (aropen_docdate BETWEEN &lt;? value("startDate") ?> AND &lt;? value("endDate") ?>);
    </sql>
 </querysource>
 <querysource>
  <name>totaldebit</name>
  <sql>SELECT formatExtPrice(SUM(ABS(gltrans_amount))) AS total
FROM gltrans
WHERE ((gltrans_amount &lt; 0)
 AND (gltrans_source='S/O')
 AND (gltrans_date BETWEEN &lt;? value("startDate") ?> AND &lt;? value("endDate") ?>));
    </sql>
 </querysource>
 <querysource>
  <name>totalcredit</name>
  <sql>SELECT formatExtPrice(SUM(gltrans_amount)) AS total
FROM gltrans
WHERE ((gltrans_amount > 0)
 AND (gltrans_source='S/O')
 AND (gltrans_date BETWEEN &lt;? value("startDate") ?> AND &lt;? value("endDate") ?>));
    </sql>
 </querysource>
 <rpthead>
  <height>128</height>
  <label>
   <rect>
    <x>0</x>
    <y>100</y>
    <width>80</width>
    <height>20</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>10</size>
    <weight>bold</weight>
   </font>
   <hcenter/>
   <vcenter/>
   <string>Doc. Type</string>
  </label>
  <line>
   <xstart>5</xstart>
   <ystart>120</ystart>
   <xend>745</xend>
   <yend>120</yend>
   <weight>2</weight>
  </line>
  <label>
   <rect>
    <x>525</x>
    <y>5</y>
    <width>217</width>
    <height>40</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>20</size>
    <weight>bold</weight>
   </font>
   <right/>
   <vcenter/>
   <string>Sales Journal</string>
  </label>
  <label>
   <rect>
    <x>85</x>
    <y>100</y>
    <width>80</width>
    <height>20</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>10</size>
    <weight>bold</weight>
   </font>
   <left/>
   <vcenter/>
   <string>Doc. #</string>
  </label>
  <label>
   <rect>
    <x>165</x>
    <y>100</y>
    <width>80</width>
    <height>20</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>10</size>
    <weight>bold</weight>
   </font>
   <hcenter/>
   <vcenter/>
   <string>Doc. Date</string>
  </label>
  <label>
   <rect>
    <x>645</x>
    <y>100</y>
    <width>100</width>
    <height>20</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>10</size>
    <weight>bold</weight>
   </font>
   <hcenter/>
   <vcenter/>
   <string>Credits</string>
  </label>
  <label>
   <rect>
    <x>250</x>
    <y>100</y>
    <width>200</width>
    <height>20</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>10</size>
    <weight>bold</weight>
   </font>
   <hcenter/>
   <vcenter/>
   <string>Customer</string>
  </label>
  <label>
   <rect>
    <x>540</x>
    <y>100</y>
    <width>100</width>
    <height>20</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>10</size>
    <weight>bold</weight>
   </font>
   <hcenter/>
   <vcenter/>
   <string>Debits</string>
  </label>
 </rpthead>
 <section>
  <name>detail</name>
  <group>
   <name>detail</name>
   <column>aropen_docnumber</column>
   <head>
    <height>23</height>
    <field>
     <rect>
      <x>645</x>
      <y>0</y>
      <width>60</width>
      <height>20</height>
     </rect>
     <font>
      <face>Arial</face>
      <size>10</size>
      <weight>normal</weight>
     </font>
     <left/>
     <vcenter/>
     <data>
      <query>detail</query>
      <column>docsence</column>
     </data>
    </field>
    <field>
     <rect>
      <x>0</x>
      <y>0</y>
      <width>80</width>
      <height>20</height>
     </rect>
     <font>
      <face>Arial</face>
      <size>10</size>
      <weight>normal</weight>
     </font>
     <hcenter/>
     <vcenter/>
     <data>
      <query>detail</query>
      <column>aropen_doctype</column>
     </data>
    </field>
    <field>
     <rect>
      <x>252</x>
      <y>0</y>
      <width>80</width>
      <height>20</height>
     </rect>
     <font>
      <face>Arial</face>
      <size>10</size>
      <weight>normal</weight>
     </font>
     <right/>
     <vcenter/>
     <data>
      <query>detail</query>
      <column>cust_number</column>
     </data>
    </field>
    <field>
     <rect>
      <x>340</x>
      <y>0</y>
      <width>200</width>
      <height>20</height>
     </rect>
     <font>
      <face>Arial</face>
      <size>10</size>
      <weight>normal</weight>
     </font>
     <left/>
     <vcenter/>
     <data>
      <query>detail</query>
      <column>cust_name</column>
     </data>
    </field>
    <field>
     <rect>
      <x>540</x>
      <y>0</y>
      <width>100</width>
      <height>20</height>
     </rect>
     <font>
      <face>Arial</face>
      <size>10</size>
      <weight>normal</weight>
     </font>
     <right/>
     <vcenter/>
     <data>
      <query>detail</query>
      <column>openamount</column>
     </data>
    </field>
    <field>
     <rect>
      <x>165</x>
      <y>0</y>
      <width>90</width>
      <height>20</height>
     </rect>
     <font>
      <face>Arial</face>
      <size>10</size>
      <weight>normal</weight>
     </font>
     <left/>
     <vcenter/>
     <data>
      <query>detail</query>
      <column>docdate</column>
     </data>
    </field>
    <field>
     <rect>
      <x>85</x>
      <y>0</y>
      <width>80</width>
      <height>20</height>
     </rect>
     <font>
      <face>Arial</face>
      <size>10</size>
      <weight>normal</weight>
     </font>
     <left/>
     <vcenter/>
     <data>
      <query>detail</query>
      <column>aropen_docnumber</column>
     </data>
    </field>
   </head>
   <foot>
    <height>23</height>
   </foot>
  </group>
  <detail>
   <key>
    <query>detail</query>
   </key>
   <height>23</height>
   <field>
    <rect>
     <x>0</x>
     <y>0</y>
     <width>100</width>
     <height>20</height>
    </rect>
    <font>
     <face>Arial</face>
     <size>10</size>
     <weight>normal</weight>
    </font>
    <right/>
    <vcenter/>
    <data>
     <query>detail</query>
     <column>accnt_number</column>
    </data>
   </field>
   <field>
    <rect>
     <x>640</x>
     <y>0</y>
     <width>100</width>
     <height>20</height>
    </rect>
    <font>
     <face>Arial</face>
     <size>10</size>
     <weight>normal</weight>
    </font>
    <right/>
    <vcenter/>
    <data>
     <query>detail</query>
     <column>credit</column>
    </data>
   </field>
   <field>
    <rect>
     <x>103</x>
     <y>0</y>
     <width>200</width>
     <height>20</height>
    </rect>
    <font>
     <face>Arial</face>
     <size>10</size>
     <weight>normal</weight>
    </font>
    <left/>
    <vcenter/>
    <data>
     <query>detail</query>
     <column>accnt_descrip</column>
    </data>
   </field>
   <field>
    <rect>
     <x>540</x>
     <y>0</y>
     <width>100</width>
     <height>20</height>
    </rect>
    <font>
     <face>Arial</face>
     <size>10</size>
     <weight>normal</weight>
    </font>
    <right/>
    <vcenter/>
    <data>
     <query>detail</query>
     <column>debit</column>
    </data>
   </field>
  </detail>
 </section>
 <section>
  <name>distributions</name>
  <group>
   <name>distributions</name>
   <column>gid</column>
   <head>
    <height>88</height>
    <label>
     <rect>
      <x>340</x>
      <y>40</y>
      <width>200</width>
      <height>20</height>
     </rect>
     <font>
      <face>Arial</face>
      <size>10</size>
      <weight>bold</weight>
     </font>
     <right/>
     <vcenter/>
     <string>Total Credits:</string>
    </label>
    <label>
     <rect>
      <x>5</x>
      <y>65</y>
      <width>300</width>
      <height>20</height>
     </rect>
     <font>
      <face>Arial</face>
      <size>12</size>
      <weight>bold</weight>
     </font>
     <left/>
     <vcenter/>
     <string>Summarized Distributions</string>
    </label>
    <label>
     <rect>
      <x>340</x>
      <y>20</y>
      <width>200</width>
      <height>20</height>
     </rect>
     <font>
      <face>Arial</face>
      <size>10</size>
      <weight>bold</weight>
     </font>
     <right/>
     <vcenter/>
     <string>Total Sales:</string>
    </label>
    <field>
     <rect>
      <x>540</x>
      <y>20</y>
      <width>100</width>
      <height>20</height>
     </rect>
     <font>
      <face>Arial</face>
      <size>10</size>
      <weight>normal</weight>
     </font>
     <right/>
     <vcenter/>
     <data>
      <query>totaldocsales</query>
      <column>amount</column>
     </data>
    </field>
    <field>
     <rect>
      <x>540</x>
      <y>40</y>
      <width>100</width>
      <height>20</height>
     </rect>
     <font>
      <face>Arial</face>
      <size>10</size>
      <weight>normal</weight>
     </font>
     <right/>
     <vcenter/>
     <data>
      <query>totaldoccredit</query>
      <column>amount</column>
     </data>
    </field>
   </head>
   <foot>
    <height>23</height>
   </foot>
  </group>
  <detail>
   <key>
    <query>distributions</query>
   </key>
   <height>23</height>
   <field>
    <rect>
     <x>103</x>
     <y>0</y>
     <width>200</width>
     <height>20</height>
    </rect>
    <font>
     <face>Arial</face>
     <size>10</size>
     <weight>normal</weight>
    </font>
    <left/>
    <vcenter/>
    <data>
     <query>distributions</query>
     <column>accnt_descrip</column>
    </data>
   </field>
   <field>
    <rect>
     <x>0</x>
     <y>0</y>
     <width>100</width>
     <height>20</height>
    </rect>
    <font>
     <face>Arial</face>
     <size>10</size>
     <weight>normal</weight>
    </font>
    <right/>
    <vcenter/>
    <data>
     <query>distributions</query>
     <column>accnt_number</column>
    </data>
   </field>
   <field>
    <rect>
     <x>640</x>
     <y>0</y>
     <width>100</width>
     <height>20</height>
    </rect>
    <font>
     <face>Arial</face>
     <size>10</size>
     <weight>normal</weight>
    </font>
    <right/>
    <vcenter/>
    <data>
     <query>distributions</query>
     <column>credit</column>
    </data>
   </field>
   <field>
    <rect>
     <x>540</x>
     <y>0</y>
     <width>100</width>
     <height>20</height>
    </rect>
    <font>
     <face>Arial</face>
     <size>10</size>
     <weight>normal</weight>
    </font>
    <right/>
    <vcenter/>
    <data>
     <query>distributions</query>
     <column>debit</column>
    </data>
   </field>
  </detail>
 </section>
 <pgfoot>
  <height>18</height>
  <field>
   <rect>
    <x>705</x>
    <y>0</y>
    <width>40</width>
    <height>15</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>8</size>
    <weight>bold</weight>
   </font>
   <left/>
   <vcenter/>
   <data>
    <query>Context Query</query>
    <column>page_number</column>
   </data>
  </field>
  <label>
   <rect>
    <x>600</x>
    <y>0</y>
    <width>100</width>
    <height>15</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>8</size>
    <weight>normal</weight>
   </font>
   <right/>
   <vcenter/>
   <string>Page:</string>
  </label>
  <field>
   <rect>
    <x>85</x>
    <y>0</y>
    <width>100</width>
    <height>15</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>8</size>
    <weight>bold</weight>
   </font>
   <left/>
   <vcenter/>
   <data>
    <query>Context Query</query>
    <column>report_date</column>
   </data>
  </field>
  <label>
   <rect>
    <x>0</x>
    <y>0</y>
    <width>80</width>
    <height>15</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>8</size>
    <weight>normal</weight>
   </font>
   <right/>
   <vcenter/>
   <string>Report Date:</string>
  </label>
 </pgfoot>
 <rptfoot>
  <height>38</height>
  <label>
   <rect>
    <x>340</x>
    <y>15</y>
    <width>200</width>
    <height>20</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>10</size>
    <weight>bold</weight>
   </font>
   <right/>
   <vcenter/>
   <string>Total Distributions:</string>
  </label>
  <field>
   <rect>
    <x>640</x>
    <y>15</y>
    <width>100</width>
    <height>20</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>10</size>
    <weight>normal</weight>
   </font>
   <right/>
   <vcenter/>
   <data>
    <query>totalcredit</query>
    <column>total</column>
   </data>
  </field>
  <field>
   <rect>
    <x>540</x>
    <y>15</y>
    <width>100</width>
    <height>20</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>10</size>
    <weight>normal</weight>
   </font>
   <right/>
   <vcenter/>
   <data>
    <query>totaldebit</query>
    <column>total</column>
   </data>
  </field>
 </rptfoot>
</report>
