<!DOCTYPE openRPTDef>
<report>
 <title>Credit Memo</title>
 <name></name>
 <description></description>
 <size>Letter</size>
 <portrait/>
 <topmargin>30</topmargin>
 <bottommargin>30</bottommargin>
 <rightmargin>0</rightmargin>
 <leftmargin>0</leftmargin>
 <querysource>
  <name>GroupHead</name>
  <sql>SELECT remitto.*, cmhead_number, formatDate(cmhead_docdate) AS docdate,
               cust_number,
               cmhead_billtoname AS billtoname,
               cmhead_billtoaddress1 AS billtoaddress1,
               cmhead_billtoaddress2 AS billtoaddress2,
               cmhead_billtoaddress3 AS billtoaddress3,
               (cmhead_billtocity || '  ' || cmhead_billtostate || '  ' || cmhead_billtozip) AS billtocitystatezip,
               cust_phone,
               cmhead_shipto_name AS shiptoname,
               cmhead_shipto_address1 AS shiptoaddress1,
               cmhead_shipto_address2 AS shiptoaddress2,
               cmhead_shipto_address3 AS shiptoaddress3,
               (cmhead_shipto_city || '  ' || cmhead_shipto_state || '  ' || cmhead_shipto_zipcode) AS shiptocitystatezip,
               CASE WHEN (cmhead_invcnumber=-1) THEN ''
                         ELSE cmhead_invcnumber::text
               END AS invcnumber,
               cmhead_custponumber, cmhead_comments
FROM remitto, cmhead, cust
WHERE ((cmhead_cust_id=cust_id)
 AND (cmhead_id=%1))
ORDER BY cmhead_number;</sql>
 </querysource>
 <querysource>
  <name>Detail</name>
  <sql>SELECT cmitem_linenumber,
          formatQty(cmitem_qtycredit) AS qtycredit,
          formatQty(cmitem_qtyreturned) AS qtyreturned,
          uom_name, item_number, item_descrip1, item_descrip2,
          formatPrice(cmitem_unitprice) AS unitprice,
          formatExtPrice((cmitem_unitprice / cmitem_price_invuomratio) * (cmitem_qtycredit * cmitem_qty_invuomratio)) AS extprice
         FROM cmitem, itemsite, item, uom
         WHERE ((cmitem_itemsite_id=itemsite_id)
          AND (itemsite_item_id=item_id)
          AND (item_inv_uom_id=uom_id)
          AND (cmitem_cmhead_id=%1))
         ORDER BY cmitem_linenumber;</sql>
 </querysource>
 <querysource>
  <name>GroupFoot</name>
  <sql>SELECT formatExtPrice(SUM((cmitem_unitprice / cmitem_price_invuomratio) * (cmitem_qtycredit * cmitem_qty_invuomratio))) AS extprice,
          formatExtPrice(cmhead_freight) AS freight
         FROM cmhead, cmitem
         WHERE ((cmitem_cmhead_id=cmhead_id)
          AND (cmhead_id=%1))
         GROUP BY cmhead_id, freight;</sql>
 </querysource>
 <querysource>
  <name>GroupExtended</name>
  <sql>SELECT formatExtPrice(cmhead_freight + 
          (SELECT COALESCE(SUM((cmitem_unitprice / cmitem_price_invuomratio) * (cmitem_qtycredit * cmitem_qty_invuomratio)), 0::numeric)
           FROM cmitem
           WHERE (cmitem_cmhead_id=%1))) AS totaldue
         FROM cmhead
         WHERE (cmhead_id=%1);</sql>
 </querysource>
 <pghead>
  <firstpage/>
  <height>378</height>
  <field>
   <rect>
    <x>675</x>
    <y>50</y>
    <width>112</width>
    <height>20</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>12</size>
    <weight>normal</weight>
   </font>
   <left/>
   <vcenter/>
   <data>
    <query>GroupHead</query>
    <column>cmhead_number</column>
   </data>
  </field>
  <field>
   <rect>
    <x>260</x>
    <y>310</y>
    <width>115</width>
    <height>20</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>10</size>
    <weight>normal</weight>
   </font>
   <hcenter/>
   <vcenter/>
   <data>
    <query>GroupHead</query>
    <column>cmhead_custponumber</column>
   </data>
  </field>
  <field>
   <rect>
    <x>75</x>
    <y>245</y>
    <width>290</width>
    <height>20</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>12</size>
    <weight>normal</weight>
   </font>
   <left/>
   <vcenter/>
   <data>
    <query>GroupHead</query>
    <column>billtoaddress3</column>
   </data>
  </field>
  <field>
   <rect>
    <x>75</x>
    <y>205</y>
    <width>290</width>
    <height>20</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>12</size>
    <weight>normal</weight>
   </font>
   <left/>
   <vcenter/>
   <data>
    <query>GroupHead</query>
    <column>billtoaddress2</column>
   </data>
  </field>
  <field>
   <rect>
    <x>75</x>
    <y>185</y>
    <width>290</width>
    <height>20</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>12</size>
    <weight>normal</weight>
   </font>
   <left/>
   <vcenter/>
   <data>
    <query>GroupHead</query>
    <column>billtoaddress1</column>
   </data>
  </field>
  <field>
   <rect>
    <x>480</x>
    <y>205</y>
    <width>300</width>
    <height>20</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>12</size>
    <weight>normal</weight>
   </font>
   <left/>
   <vcenter/>
   <data>
    <query>GroupHead</query>
    <column>shiptoaddress2</column>
   </data>
  </field>
  <field>
   <rect>
    <x>0</x>
    <y>310</y>
    <width>55</width>
    <height>20</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>11</size>
    <weight>normal</weight>
   </font>
   <left/>
   <vcenter/>
   <data>
    <query>GroupHead</query>
    <column>invcnumber</column>
   </data>
  </field>
  <field>
   <rect>
    <x>480</x>
    <y>245</y>
    <width>300</width>
    <height>20</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>12</size>
    <weight>normal</weight>
   </font>
   <left/>
   <vcenter/>
   <data>
    <query>GroupHead</query>
    <column>shiptoaddress3</column>
   </data>
  </field>
  <field>
   <rect>
    <x>555</x>
    <y>50</y>
    <width>112</width>
    <height>20</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>12</size>
    <weight>normal</weight>
   </font>
   <left/>
   <vcenter/>
   <data>
    <query>GroupHead</query>
    <column>docdate</column>
   </data>
  </field>
  <field>
   <rect>
    <x>480</x>
    <y>185</y>
    <width>300</width>
    <height>20</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>12</size>
    <weight>normal</weight>
   </font>
   <left/>
   <vcenter/>
   <data>
    <query>GroupHead</query>
    <column>shiptoaddress1</column>
   </data>
  </field>
  <field>
   <rect>
    <x>60</x>
    <y>310</y>
    <width>80</width>
    <height>20</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>11</size>
    <weight>normal</weight>
   </font>
   <left/>
   <vcenter/>
   <data>
    <query>GroupHead</query>
    <column>docdate</column>
   </data>
  </field>
  <field>
   <rect>
    <x>75</x>
    <y>225</y>
    <width>290</width>
    <height>20</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>12</size>
    <weight>normal</weight>
   </font>
   <left/>
   <vcenter/>
   <data>
    <query>GroupHead</query>
    <column>billtocitystatezip</column>
   </data>
  </field>
  <field>
   <rect>
    <x>480</x>
    <y>225</y>
    <width>300</width>
    <height>20</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>12</size>
    <weight>normal</weight>
   </font>
   <left/>
   <vcenter/>
   <data>
    <query>GroupHead</query>
    <column>shiptocitystatezip</column>
   </data>
  </field>
  <field>
   <rect>
    <x>480</x>
    <y>165</y>
    <width>300</width>
    <height>20</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>12</size>
    <weight>normal</weight>
   </font>
   <left/>
   <vcenter/>
   <data>
    <query>GroupHead</query>
    <column>shiptoname</column>
   </data>
  </field>
  <field>
   <rect>
    <x>75</x>
    <y>165</y>
    <width>270</width>
    <height>20</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>12</size>
    <weight>normal</weight>
   </font>
   <left/>
   <vcenter/>
   <data>
    <query>GroupHead</query>
    <column>billtoname</column>
   </data>
  </field>
  <field>
   <rect>
    <x>145</x>
    <y>310</y>
    <width>63</width>
    <height>20</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>11</size>
    <weight>normal</weight>
   </font>
   <left/>
   <vcenter/>
   <data>
    <query>GroupHead</query>
    <column>cust_number</column>
   </data>
  </field>
 </pghead>
 <section>
  <name>detail</name>
  <detail>
   <key>
    <query>Detail</query>
   </key>
   <height>57</height>
   <field>
    <rect>
     <x>25</x>
     <y>5</y>
     <width>95</width>
     <height>20</height>
    </rect>
    <font>
     <face>Arial</face>
     <size>10</size>
     <weight>normal</weight>
    </font>
    <right/>
    <vcenter/>
    <data>
     <query>Detail</query>
     <column>qtyreturned</column>
    </data>
   </field>
   <field>
    <rect>
     <x>185</x>
     <y>5</y>
     <width>155</width>
     <height>20</height>
    </rect>
    <font>
     <face>Arial</face>
     <size>10</size>
     <weight>normal</weight>
    </font>
    <left/>
    <vcenter/>
    <data>
     <query>Detail</query>
     <column>item_number</column>
    </data>
   </field>
   <field>
    <rect>
     <x>565</x>
     <y>5</y>
     <width>70</width>
     <height>20</height>
    </rect>
    <font>
     <face>Arial</face>
     <size>10</size>
     <weight>normal</weight>
    </font>
    <hcenter/>
    <vcenter/>
    <data>
     <query>Detail</query>
     <column>uom_name</column>
    </data>
   </field>
   <field>
    <rect>
     <x>345</x>
     <y>5</y>
     <width>200</width>
     <height>20</height>
    </rect>
    <font>
     <face>Arial</face>
     <size>8</size>
     <weight>bold</weight>
    </font>
    <left/>
    <vcenter/>
    <data>
     <query>Detail</query>
     <column>item_descrip1</column>
    </data>
   </field>
   <field>
    <rect>
     <x>25</x>
     <y>25</y>
     <width>95</width>
     <height>20</height>
    </rect>
    <font>
     <face>Arial</face>
     <size>10</size>
     <weight>normal</weight>
    </font>
    <right/>
    <vcenter/>
    <data>
     <query>Detail</query>
     <column>qtycredit</column>
    </data>
   </field>
   <field>
    <rect>
     <x>675</x>
     <y>25</y>
     <width>100</width>
     <height>20</height>
    </rect>
    <font>
     <face>Arial</face>
     <size>10</size>
     <weight>normal</weight>
    </font>
    <right/>
    <vcenter/>
    <data>
     <query>Detail</query>
     <column>extprice</column>
    </data>
   </field>
   <field>
    <rect>
     <x>675</x>
     <y>5</y>
     <width>100</width>
     <height>20</height>
    </rect>
    <font>
     <face>Arial</face>
     <size>10</size>
     <weight>normal</weight>
    </font>
    <right/>
    <vcenter/>
    <data>
     <query>Detail</query>
     <column>unitprice</column>
    </data>
   </field>
   <field>
    <rect>
     <x>125</x>
     <y>5</y>
     <width>55</width>
     <height>20</height>
    </rect>
    <font>
     <face>Arial</face>
     <size>10</size>
     <weight>normal</weight>
    </font>
    <hcenter/>
    <vcenter/>
    <data>
     <query>Detail</query>
     <column>uom_name</column>
    </data>
   </field>
   <field>
    <rect>
     <x>345</x>
     <y>25</y>
     <width>200</width>
     <height>20</height>
    </rect>
    <font>
     <face>Arial</face>
     <size>8</size>
     <weight>bold</weight>
    </font>
    <left/>
    <vcenter/>
    <data>
     <query>Detail</query>
     <column>item_descrip2</column>
    </data>
   </field>
  </detail>
 </section>
 <pgfoot>
  <firstpage/>
  <height>148</height>
  <text>
   <rect>
    <x>150</x>
    <y>20</y>
    <width>345</width>
    <height>17</height>
   </rect>
   <bottompad>15</bottompad>
   <font>
    <face>Arial</face>
    <size>10</size>
    <weight>normal</weight>
   </font>
   <left/>
   <top/>
   <data>
    <query>GroupHead</query>
    <column>cmhead_comments</column>
   </data>
  </text>
  <field>
   <rect>
    <x>655</x>
    <y>60</y>
    <width>100</width>
    <height>15</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>10</size>
    <weight>normal</weight>
   </font>
   <right/>
   <vcenter/>
   <data>
    <query>GroupFoot</query>
    <column>freight</column>
   </data>
  </field>
  <field>
   <rect>
    <x>655</x>
    <y>20</y>
    <width>100</width>
    <height>20</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>10</size>
    <weight>normal</weight>
   </font>
   <right/>
   <vcenter/>
   <data>
    <query>GroupFoot</query>
    <column>extprice</column>
   </data>
  </field>
  <label>
   <rect>
    <x>760</x>
    <y>125</y>
    <width>34</width>
    <height>15</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>10</size>
    <weight>normal</weight>
   </font>
   <left/>
   <top/>
   <string>(CR)</string>
  </label>
  <label>
   <rect>
    <x>760</x>
    <y>60</y>
    <width>34</width>
    <height>15</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>10</size>
    <weight>normal</weight>
   </font>
   <left/>
   <top/>
   <string>(CR)</string>
  </label>
  <label>
   <rect>
    <x>760</x>
    <y>95</y>
    <width>34</width>
    <height>15</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>10</size>
    <weight>normal</weight>
   </font>
   <left/>
   <top/>
   <string>(CR)</string>
  </label>
  <label>
   <rect>
    <x>760</x>
    <y>20</y>
    <width>34</width>
    <height>15</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>10</size>
    <weight>normal</weight>
   </font>
   <left/>
   <top/>
   <string>(CR)</string>
  </label>
  <field>
   <rect>
    <x>655</x>
    <y>95</y>
    <width>100</width>
    <height>15</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>10</size>
    <weight>normal</weight>
   </font>
   <right/>
   <vcenter/>
   <data>
    <query>GroupExtended</query>
    <column>totaldue</column>
   </data>
  </field>
  <field>
   <rect>
    <x>655</x>
    <y>125</y>
    <width>100</width>
    <height>15</height>
   </rect>
   <font>
    <face>Arial</face>
    <size>10</size>
    <weight>normal</weight>
   </font>
   <right/>
   <vcenter/>
   <data>
    <query>GroupExtended</query>
    <column>totaldue</column>
   </data>
  </field>
 </pgfoot>
</report>
